---
title: "Análisis de Conjunto de Genes"
author: "Aarón García Blázquez"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    number_sections: false
    theme: cerulean
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE)
```

```{r load packages}
rm(list = ls())

library(mdgsa)
library(clusterProfiler)
library(enrichplot)
library(fgsea)
library(org.Dr.eg.db)
library(ggplot2)
library(pathview)
library(KEGGREST)
```

# Contrastes {.tabset}

## 72 hpf vs 48 hpf {.tabset}

```{r data load 1}
load("tt_72_48.RData")
diffexp <- tt_72_48$table

# differential expressed genes
print("Número de genes significativos")
table(diffexp$FDR < 0.05)
```

```{r}
geneList <- diffexp$LogFC
names(geneList) <- rownames(diffexp)
geneList <- sort(geneList, decreasing = TRUE)
```

```{r}
## Benjamini & Hochberg correction
# load(file = "data/GSEA_BH.RData")
gsea_BH <- gseGO(geneList  = geneList,
                 ont       = "BP",
                 OrgDb     = org.Rn.eg.db,
                 keyType   = 'SYMBOL',
                 verbose   = T,
                 minGSSize = 10,
                 maxGSSize = 500,
                 pvalueCutoff = 1,
                 pAdjustMethod = "BH",
                 seed      = T)
# save(gsea_BH, file = "data/GSEA_BH.RData")
dim(gsea_BH)

dotplot(gsea_BH, showCategory = 20) + ggtitle("GSEA")
```








<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;"></div>