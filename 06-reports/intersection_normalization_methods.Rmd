---
title: "Intersection TMM y TMM+QN"
author: "Aarón García Blázquez"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
rm(list = ls())
```

```{r}
require(rstudioapi)
```

```{r}
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
```

# Carga de los datos

## TMM {.tabset}

```{r}
normalization <- "TMM"
```

```{r}
load(paste0(normalization, "_tt_72_48.RData"))
load(paste0(normalization, "_tt_120_72.RData"))
load(paste0(normalization, "_tt_adult_120.RData"))
```

### Genes significativos 72 hpf vs 48 hpf

#### Genes sobreexpresados

```{r}
tmm_up_72_48 <- tt_72_48$table[which(tt_72_48$table['FDR'] < 0.05 & tt_72_48$table['logFC'] > 1.5) , "Gene"]
```

#### Genes infraexpresados

```{r}
tmm_down_72_48 <- tt_72_48$table[which(tt_72_48$table['FDR'] < 0.05 & tt_72_48$table['logFC'] < -1.5) , "Gene"]
```

### Genes significativos 120 hpf vs 72 hpf

#### Genes sobreexpresados

```{r}
tmm_up_120_72 <- tt_120_72$table[which(tt_120_72$table['FDR'] < 0.05 & tt_120_72$table['logFC'] > 1.5) , "Gene"]
```

#### Genes infraexpresados

```{r}
tmm_down_120_72 <- tt_120_72$table[which(tt_120_72$table['FDR'] < 0.05 & tt_120_72$table['logFC'] < -1.5) , "Gene"]
```

### Genes significativos Adultos vs 120 hpf

#### Genes sobreexpresados

```{r}
tmm_up_adult_120 <- tt_adult_120$table[which(tt_adult_120$table['FDR'] < 0.05 & tt_adult_120$table['logFC'] > 1.5) , "Gene"]
```

#### Genes infraexpresados

```{r}
tmm_down_adult_120 <- tt_adult_120$table[which(tt_adult_120$table['FDR'] < 0.05 & tt_adult_120$table['logFC'] < -1.5) , "Gene"]
```

## TMM + QN {.tabset}

```{r}
normalization <- "QN"
```

```{r}
load(paste0(normalization, "_tt_72_48.RData"))
load(paste0(normalization, "_tt_120_72.RData"))
load(paste0(normalization, "_tt_adult_120.RData"))
```

### Genes significativos 72 hpf vs 48 hpf {.tabset}

#### Genes sobreexpresados

```{r}
qn_up_72_48 <- tt_72_48$table[which(tt_72_48$table['FDR'] < 0.05 & tt_72_48$table['logFC'] > 1.5) , "Gene"]
```

#### Genes infraexpresados

```{r}
qn_down_72_48 <- tt_72_48$table[which(tt_72_48$table['FDR'] < 0.05 & tt_72_48$table['logFC'] < -1.5) , "Gene"]
```

### Genes significativos 120 hpf vs 72 hpf

#### Genes sobreexpresados

```{r}
qn_up_120_72 <- tt_120_72$table[which(tt_120_72$table['FDR'] < 0.05 & tt_120_72$table['logFC'] > 1.5) , "Gene"]
```

#### Genes infraexpresados

```{r}
qn_down_120_72 <- tt_120_72$table[which(tt_120_72$table['FDR'] < 0.05 & tt_120_72$table['logFC'] < -1.5) , "Gene"]
```

### Genes significativos Adultos vs 120 hpf

#### Genes sobreexpresados

```{r}
qn_up_adult_120 <- tt_adult_120$table[which(tt_adult_120$table['FDR'] < 0.05 & tt_adult_120$table['logFC'] > 1.5) , "Gene"]
```

#### Genes infraexpresados

```{r}
qn_down_adult_120 <- tt_adult_120$table[which(tt_adult_120$table['FDR'] < 0.05 & tt_adult_120$table['logFC'] < -1.5) , "Gene"]
```

# Intersección de los genes significativos

```{r}
groups <- c("TMM", "TMM + QN")
```

```{r}
ups_72_48 <- list(tmm_up_72_48, qn_up_72_48)
ups_120_72 <- list(tmm_up_120_72, qn_up_120_72)
ups_adult_120 <- list(tmm_up_adult_120, qn_up_adult_120)
```

```{r}
downs_72_48 <- list(tmm_down_72_48, qn_down_72_48)
downs_120_72 <- list(tmm_down_120_72, qn_down_120_72)
downs_adult_120 <- list(tmm_up_adult_120, qn_up_adult_120)
```









