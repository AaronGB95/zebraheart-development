---
title: "Report"
author: "Aarón García Blázquez"
date: "2023-12-19"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE)
```

```{r}
dir_docs <- "~/zebraheart-development/01-documentation/"
dir_src <- "~/zebraheart-development/02-scripts/"
dir_data <- "~/zebraheart-development/03-data/"
dir_output <- "~/zebraheart-development/04-output/"
dir_load <- paste0(dir_output, "gene_set_enrichment_analysis/")
```

```{r}
require(DT)
require(GOfuncR)
```

```{r}
tabla <- function(table) {
  table %>%
  DT::datatable(extensions = 'Buttons',
                options = list(pageLength = 10,                
                             dom = 'Blfrtip',
                             order = list(list(1, 'asc')),
                             buttons = list('colvis', 
                                             list(title = NULL,
                                                  extend = list('copy'),
                                                  exportOptions = list(columns = ":visible"),
                                                  text = "Copy"),
                                             list(title = NULL,
                                                  extend = list('csv'),
                                                  exportOptions = list(columns = ":visible"),
                                                  text = ".csv"),
                                             list(title = NULL,
                                                  extend = list('excel'),
                                                  exportOptions = list(columns = ":visible"),
                                                  text = "Excel"),
                                             list(title = "PDF Report",
                                                  extend = list('pdf'),
                                                  exportOptions = list(columns = ":visible"),
                                                  text = ".pdf"),
                                             list(title = NULL,
                                                  extend = list('print'),
                                                  exportOptions = list(columns = ":visible"),
                                                  text = "Print")
                                              )),
              filter = "top", 
              escape = FALSE, 
              rownames = TRUE)  %>%
  formatSignif(columns = c("enrichmentScore", "NES", "pvalue", "p.adjust", "qvalue"), digits=3) %>%
  formatStyle('pvalue', 
              fontWeight = styleInterval(0.05, c('bold', 'normal')), 
              color = styleInterval(0.05, c('green', 'black'))) %>%
  formatStyle('p.adjust', 
              fontWeight = styleInterval(0.05, c('bold', 'normal')), 
              color = styleInterval(0.05, c('green', 'black')))
}
```

# Reactome Functional Analysis {.tabset}

## Zebrafish {.tabset}

### 72 hpf vs 48 hpf

```{r}
load(paste0(dir_load, "zebrafish_TMM_GSEA_Reactome_72_48.RData"))

# differential expressed terms
print(paste("Número de términos con genes significativos:", dim(gsea_reac)[1]))
print(paste("Número de términos significativos:", length(which(gsea_reac@result$p.adjust < 0.05))))
```

```{r}
tabla(gsea_reac@result)
```

### 120 hpf vs 72 hpf

```{r}
load(paste0(dir_load, "zebrafish_TMM_GSEA_Reactome_120_72.RData"))

# differential expressed terms
print(paste("Número de términos con genes significativos:", dim(gsea_reac)[1]))
print(paste("Número de términos significativos:", length(which(gsea_reac@result$p.adjust < 0.05))))
```

```{r}
tabla(gsea_reac@result)
```

### Adult vs 120 hpf

```{r}
load(paste0(dir_load, "zebrafish_TMM_GSEA_Reactome_adult_120.RData"))

# differential expressed terms
print(paste("Número de términos con genes significativos:", dim(gsea_reac)[1]))
print(paste("Número de términos significativos:", length(which(gsea_reac@result$p.adjust < 0.05))))
```

```{r}
tabla(gsea_reac@result)
```

## Human {.tabset}

### 72 hpf vs 48 hpf

```{r}
load(paste0(dir_load, "human_TMM_GSEA_Reactome_72_48.RData"))

# differential expressed terms
print(paste("Número de términos con genes significativos:", dim(gsea_reac)[1]))
print(paste("Número de términos significativos:", length(which(gsea_reac@result$p.adjust < 0.05))))
```

```{r}
tabla(gsea_reac@result)
```

### 120 hpf vs 72 hpf

```{r}
load(paste0(dir_load, "human_TMM_GSEA_Reactome_120_72.RData"))

# differential expressed terms
print(paste("Número de términos con genes significativos:", dim(gsea_reac)[1]))
print(paste("Número de términos significativos:", length(which(gsea_reac@result$p.adjust < 0.05))))
```

```{r}
tabla(gsea_reac@result)
```

### Adult vs 120 hpf

```{r}
load(paste0(dir_load, "human_TMM_GSEA_Reactome_adult_120.RData"))

# differential expressed terms
print(paste("Número de términos con genes significativos:", dim(gsea_reac)[1]))
print(paste("Número de términos significativos:", length(which(gsea_reac@result$p.adjust < 0.05))))
```

```{r}
tabla(gsea_reac@result)
```

## Mouse {.tabset}

### 72 hpf vs 48 hpf

```{r}
load(paste0(dir_load, "mouse_TMM_GSEA_Reactome_72_48.RData"))

# differential expressed terms
print(paste("Número de términos con genes significativos:", dim(gsea_reac)[1]))
print(paste("Número de términos significativos:", length(which(gsea_reac@result$p.adjust < 0.05))))
```

```{r}
tabla(gsea_reac@result)
```

### 120 hpf vs 72 hpf

```{r}
load(paste0(dir_load, "mouse_TMM_GSEA_Reactome_120_72.RData"))

# differential expressed terms
print(paste("Número de términos con genes significativos:", dim(gsea_reac)[1]))
print(paste("Número de términos significativos:", length(which(gsea_reac@result$p.adjust < 0.05))))
```

```{r}
tabla(gsea_reac@result)
```

### Adult vs 120 hpf

```{r}
load(paste0(dir_load, "mouse_TMM_GSEA_Reactome_adult_120.RData"))

# differential expressed terms
print(paste("Número de términos con genes significativos:", dim(gsea_reac)[1]))
print(paste("Número de términos significativos:", length(which(gsea_reac@result$p.adjust < 0.05))))
```

```{r}
tabla(gsea_reac@result)
```

---

# Términos Generales seleccionados para clasificación {.tabset}

```{r}
heart_development <- "GO:0007507"
cardiac_contraction <- "GO:0003015"
calcium_transport <- "GO:0006816"
```

## Heart development

```{r}
child_nodes <- get_child_nodes(heart_development)
DT::datatable(child_nodes)
```

## Cardiac contraction

```{r}
child_nodes <- get_child_nodes(cardiac_contraction)
DT::datatable(child_nodes)
```

## Calcium transport

```{r}
child_nodes <- get_child_nodes(calcium_transport)
DT::datatable(child_nodes)
```

---

# Clasificación de términos funcionales {.tabset}

```{r go_terms}
ont1 <- "GO:0007507 (Heart development)"
heart_development <- read.table(file = paste0(dir_docs,
                                              "heart_development.txt"))

ont2 <- "GO:0003015 (Cardiac contraction)"
cardiac_contraction <- read.table(file = paste0(dir_docs,
                                                "cardiac_contraction.txt"))

ont3 <- "GO:0006816 (Calcium transport)"
calcium_transport <- read.table(file = paste0(dir_docs,
                                              "calcium_transport.txt"))
```

## Zebrafish {.tabset}

### Own Gene Universe {.tabset}

#### 72 hpf vs 48 hpf

```{r}
load(paste0(dir_output,
            "gene_set_enrichment_analysis/",
            "TMM_GSEA_OG_GOBP_72_48.RData"))

sig_terms <- gsea_GO_OG@result[gsea_GO_OG@result$p.adjust < 0.05, ]
```

```{r}
dev_terms <- sig_terms$ID %in% heart_development$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont1))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("ID", "Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% cardiac_contraction$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont2))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% calcium_transport$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont3))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

#### 120 hpf vs 72 hpf

```{r}
load(paste0(dir_output,
            "gene_set_enrichment_analysis/",
            "TMM_GSEA_OG_GOBP_120_72.RData"))

sig_terms <- gsea_GO_OG@result[gsea_GO_OG@result$p.adjust < 0.05, ]
```

```{r}
dev_terms <- sig_terms$ID %in% heart_development$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont1))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% cardiac_contraction$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont2))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% calcium_transport$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont3))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

#### Adults vs 120 hpf

```{r}
load(paste0(dir_output,
            "gene_set_enrichment_analysis/",
            "TMM_GSEA_OG_GOBP_adult_120.RData"))

sig_terms <- gsea_GO_OG@result[gsea_GO_OG@result$p.adjust < 0.05, ]
```

```{r}
dev_terms <- sig_terms$ID %in% heart_development$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont1))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% cardiac_contraction$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont2))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% calcium_transport$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont3))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

### Db Package Universe {.tabset}

#### 72 hpf vs 48 hpf

```{r}
load(paste0(dir_output,
            "gene_set_enrichment_analysis/",
            "TMM_GSEA_DB_GOBP_72_48.RData"))

sig_terms <- gsea_GO_DB@result[gsea_GO_DB@result$p.adjust < 0.05, ]
```

```{r}
dev_terms <- sig_terms$ID %in% heart_development$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont1))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% cardiac_contraction$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont2))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% calcium_transport$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont3))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

#### 120 hpf vs 72 hpf

```{r}
load(paste0(dir_output,
            "gene_set_enrichment_analysis/",
            "TMM_GSEA_DB_GOBP_120_72.RData"))

sig_terms <- gsea_GO_DB@result[gsea_GO_DB@result$p.adjust < 0.05, ]
```

```{r}
dev_terms <- sig_terms$ID %in% heart_development$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont1))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% cardiac_contraction$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont2))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% calcium_transport$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont3))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

#### Adults vs 120 hpf

```{r}
load(paste0(dir_output,
            "gene_set_enrichment_analysis/",
            "TMM_GSEA_DB_GOBP_adult_120.RData"))

sig_terms <- gsea_GO_DB@result[gsea_GO_DB@result$p.adjust < 0.05, ]
```

```{r}
dev_terms <- sig_terms$ID %in% heart_development$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont1))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% cardiac_contraction$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont2))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% calcium_transport$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont3))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

## Human {.tabset}

### Own Gene Universe {.tabset}

#### 72 hpf vs 48 hpf

```{r}
load(paste0(dir_output,
            "gene_set_enrichment_analysis/",
            "human_TMM_GSEA_OG_GOBP_72_48.RData"))

sig_terms <- gsea_GO_OG@result[gsea_GO_OG@result$p.adjust < 0.05, ]
```

```{r}
dev_terms <- sig_terms$ID %in% heart_development$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont1))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% cardiac_contraction$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont2))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% calcium_transport$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont3))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

#### 120 hpf vs 72 hpf

```{r}
load(paste0(dir_output,
            "gene_set_enrichment_analysis/",
            "human_TMM_GSEA_OG_GOBP_120_72.RData"))

sig_terms <- gsea_GO_OG@result[gsea_GO_OG@result$p.adjust < 0.05, ]
```

```{r}
dev_terms <- sig_terms$ID %in% heart_development$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont1))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% cardiac_contraction$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont2))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% calcium_transport$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont3))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

#### Adults vs 120 hpf

```{r}
load(paste0(dir_output,
            "gene_set_enrichment_analysis/",
            "human_TMM_GSEA_OG_GOBP_adult_120.RData"))

sig_terms <- gsea_GO_OG@result[gsea_GO_OG@result$p.adjust < 0.05, ]
```

```{r}
dev_terms <- sig_terms$ID %in% heart_development$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont1))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% cardiac_contraction$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont2))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% calcium_transport$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont3))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

### Db Package Universe {.tabset}

#### 72 hpf vs 48 hpf

```{r}
load(paste0(dir_output,
            "gene_set_enrichment_analysis/",
            "human_TMM_GSEA_DB_GOBP_72_48.RData"))

sig_terms <- gsea_GO_DB@result[gsea_GO_DB@result$p.adjust < 0.05, ]
```

```{r}
dev_terms <- sig_terms$ID %in% heart_development$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont1))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% cardiac_contraction$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont2))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% calcium_transport$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont3))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

#### 120 hpf vs 72 hpf

```{r}
load(paste0(dir_output,
            "gene_set_enrichment_analysis/",
            "human_TMM_GSEA_DB_GOBP_120_72.RData"))

sig_terms <- gsea_GO_DB@result[gsea_GO_DB@result$p.adjust < 0.05, ]
```

```{r}
dev_terms <- sig_terms$ID %in% heart_development$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont1))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% cardiac_contraction$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont2))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% calcium_transport$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont3))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

#### Adults vs 120 hpf

```{r}
load(paste0(dir_output,
            "gene_set_enrichment_analysis/",
            "human_TMM_GSEA_DB_GOBP_adult_120.RData"))

sig_terms <- gsea_GO_DB@result[gsea_GO_DB@result$p.adjust < 0.05, ]
```

```{r}
dev_terms <- sig_terms$ID %in% heart_development$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont1))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% cardiac_contraction$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont2))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% calcium_transport$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont3))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```
## Mouse {.tabset}

### Own Gene Universe {.tabset}

#### 72 hpf vs 48 hpf

```{r}
load(paste0(dir_output,
            "gene_set_enrichment_analysis/",
            "mouse_TMM_GSEA_OG_GOBP_72_48.RData"))

sig_terms <- gsea_GO_OG@result[gsea_GO_OG@result$p.adjust < 0.05, ]
```

```{r}
dev_terms <- sig_terms$ID %in% heart_development$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont1))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% cardiac_contraction$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont2))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% calcium_transport$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont3))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

#### 120 hpf vs 72 hpf

```{r}
load(paste0(dir_output,
            "gene_set_enrichment_analysis/",
            "mouse_TMM_GSEA_OG_GOBP_120_72.RData"))

sig_terms <- gsea_GO_OG@result[gsea_GO_OG@result$p.adjust < 0.05, ]
```

```{r}
dev_terms <- sig_terms$ID %in% heart_development$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont1))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% cardiac_contraction$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont2))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% calcium_transport$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont3))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

#### Adults vs 120 hpf

```{r}
load(paste0(dir_output,
            "gene_set_enrichment_analysis/",
            "mouse_TMM_GSEA_OG_GOBP_adult_120.RData"))

sig_terms <- gsea_GO_OG@result[gsea_GO_OG@result$p.adjust < 0.05, ]
```

```{r}
dev_terms <- sig_terms$ID %in% heart_development$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont1))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% cardiac_contraction$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont2))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% calcium_transport$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont3))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

### Db Package Universe {.tabset}

#### 72 hpf vs 48 hpf

```{r}
load(paste0(dir_output,
            "gene_set_enrichment_analysis/",
            "mouse_TMM_GSEA_DB_GOBP_72_48.RData"))

sig_terms <- gsea_GO_DB@result[gsea_GO_DB@result$p.adjust < 0.05, ]
```

```{r}
dev_terms <- sig_terms$ID %in% heart_development$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont1))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% cardiac_contraction$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont2))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% calcium_transport$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont3))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

#### 120 hpf vs 72 hpf

```{r}
load(paste0(dir_output,
            "gene_set_enrichment_analysis/",
            "mouse_TMM_GSEA_DB_GOBP_120_72.RData"))

sig_terms <- gsea_GO_DB@result[gsea_GO_DB@result$p.adjust < 0.05, ]
```

```{r}
dev_terms <- sig_terms$ID %in% heart_development$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont1))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% cardiac_contraction$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont2))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% calcium_transport$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont3))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

#### Adults vs 120 hpf

```{r}
load(paste0(dir_output,
            "gene_set_enrichment_analysis/",
            "mouse_TMM_GSEA_DB_GOBP_adult_120.RData"))

sig_terms <- gsea_GO_DB@result[gsea_GO_DB@result$p.adjust < 0.05, ]
```

```{r}
dev_terms <- sig_terms$ID %in% heart_development$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont1))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont1))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% cardiac_contraction$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont2))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont2))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

```{r}
dev_terms <- sig_terms$ID %in% calcium_transport$V1

n_terms <- length(which(dev_terms == TRUE))

if (n_terms == 0) {
  print(paste0("There are no significant terms related to ", ont3))
} else if (n_terms == 1) {
  print(paste0("There is ", n_terms, " significant term related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
} else {
  print(paste0("There are ", n_terms, " significant terms related to ", ont3))
  print(sig_terms[which(dev_terms == TRUE), c("Description", "NES")])
}
```

